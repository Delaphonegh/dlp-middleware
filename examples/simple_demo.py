#!/usr/bin/env python3
"""
Simple demo: Extract recording file paths from JSON response.
"""

import sys
import os

# Add the src directory to Python path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..', 'src'))

from utils.simple_recording_filter import get_recording_paths

# Your JSON data
your_json_data = {
    "time_period": {
        "start_date": "2025-05-28",
        "end_date": "2025-05-28",
        "total_days": 1
    },
    "filters": {
        "src": "1010",
        "dst": "0506743388",
        "disposition": None,
        "direction": "all",
        "min_duration": None,
        "max_duration": None,
        "has_recording": None,
        "did": None,
        "extension": None,
        "cnam": None,
        "queue": None,
        "unique_callers_only": False
    },
    "summary": {
        "total_calls": 12,
        "answered_calls": 12,
        "no_answer_calls": 0,
        "busy_calls": 0,
        "failed_calls": 0,
        "avg_duration": 165.33,
        "total_duration": 1984,
        "avg_billsec": 159.92,
        "total_billsec": 1919,
        "answer_rate": 100.0,
        "total_inbound": 9,
        "total_outbound": 3,
        "total_internal": 0,
        "total_unknown": 0,
        "recording_count": 12,
        "recording_percentage": 100.0,
        "unique_callers": 8
    },
    "total_count": 12,
    "filtered_count": 12,
    "records": [
        {
            "calldate": "2025-05-28T11:36:19",
            "clid": "\"+233551713324\" <+233551713324>",
            "src": "+233551713324",
            "dst": "11111",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-000007a2",
            "dstchannel": "Agent/106",
            "lastapp": "Queue",
            "lastdata": "11111,t,,custom/Incoming_Call_English,,,,,,",
            "duration": 47,
            "billsec": 47,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748432179.2132",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11111-+233551713324-20250528-113632-1748432179.2132.WAV",
            "cnum": "+233551713324",
            "cnam": "+233551713324",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T11:21:55",
            "clid": "\"+233552309619\" <+233552309619>",
            "src": "+233552309619",
            "dst": "11112",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-000007a1",
            "dstchannel": "Agent/112",
            "lastapp": "Queue",
            "lastdata": "11112,tr,,custom/Incoming_Call_Twi,,,,,,",
            "duration": 287,
            "billsec": 287,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748431315.2130",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11112-+233552309619-20250528-112208-1748431315.2130.wav",
            "cnum": "+233552309619",
            "cnam": "+233552309619",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T11:21:04",
            "clid": "\"+233552309619\" <+233552309619>",
            "src": "+233552309619",
            "dst": "11112",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-000007a0",
            "dstchannel": "Agent/106",
            "lastapp": "Queue",
            "lastdata": "11112,tr,,custom/Incoming_Call_Twi,,,,,,",
            "duration": 46,
            "billsec": 46,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748431264.2128",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11112-+233552309619-20250528-112116-1748431264.2128.wav",
            "cnum": "+233552309619",
            "cnam": "+233552309619",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T11:06:16",
            "clid": "1010",
            "src": "1010",
            "dst": "0500093168",
            "dcontext": "from-internal",
            "channel": "SIP/1010-0000079e",
            "dstchannel": "SIP/connexcs-0000079f",
            "lastapp": "Dial",
            "lastdata": "SIP/connexcs/7525300500093168,300,Tt",
            "duration": 248,
            "billsec": 221,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748430376.2126",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/out-0500093168-1010-20250528-110616-1748430376.2126.wav",
            "cnum": "1010",
            "cnam": "Ronny Tawiah",
            "outbound_cnum": "0242436900",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "",
            "direction": "outbound"
        },
        {
            "calldate": "2025-05-28T11:03:09",
            "clid": "1010",
            "src": "1010",
            "dst": "0500093168",
            "dcontext": "from-internal",
            "channel": "SIP/1010-0000079c",
            "dstchannel": "SIP/connexcs-0000079d",
            "lastapp": "Dial",
            "lastdata": "SIP/connexcs/7525300500093168,300,Tt",
            "duration": 183,
            "billsec": 155,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748430189.2124",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/out-0500093168-1010-20250528-110309-1748430189.2124.wav",
            "cnum": "1010",
            "cnam": "Ronny Tawiah",
            "outbound_cnum": "0242436900",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "",
            "direction": "outbound"
        },
        {
            "calldate": "2025-05-28T10:58:09",
            "clid": "\"+233500093168\" <+233500093168>",
            "src": "+233500093168",
            "dst": "11111",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-0000079b",
            "dstchannel": "Agent/113",
            "lastapp": "Queue",
            "lastdata": "11111,t,,custom/Incoming_Call_English,,,,,,",
            "duration": 278,
            "billsec": 278,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748429889.2122",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11111-+233500093168-20250528-105835-1748429889.2122.WAV",
            "cnum": "+233500093168",
            "cnam": "+233500093168",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T10:51:19",
            "clid": "\"+233207688764\" <+233207688764>",
            "src": "+233207688764",
            "dst": "11111",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-0000079a",
            "dstchannel": "Agent/112",
            "lastapp": "Queue",
            "lastdata": "11111,t,,custom/Incoming_Call_English,,,,,,",
            "duration": 23,
            "billsec": 23,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748429479.2120",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11111-+233207688764-20250528-105129-1748429479.2120.WAV",
            "cnum": "+233207688764",
            "cnam": "+233207688764",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T09:37:04",
            "clid": "\"+233243801444\" <+233243801444>",
            "src": "+233243801444",
            "dst": "11111",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-00000793",
            "dstchannel": "Agent/113",
            "lastapp": "Queue",
            "lastdata": "11111,t,,custom/Incoming_Call_English,,,,,,",
            "duration": 62,
            "billsec": 62,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748425024.2112",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11111-+233243801444-20250528-093742-1748425024.2112.WAV",
            "cnum": "+233243801444",
            "cnam": "+233243801444",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T09:31:35",
            "clid": "\"+233243801444\" <+233243801444>",
            "src": "+233243801444",
            "dst": "11111",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-00000792",
            "dstchannel": "Agent/113",
            "lastapp": "Queue",
            "lastdata": "11111,t,,custom/Incoming_Call_English,,,,,,",
            "duration": 55,
            "billsec": 55,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748424695.2110",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11111-+233243801444-20250528-093214-1748424695.2110.WAV",
            "cnum": "+233243801444",
            "cnam": "+233243801444",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T09:13:29",
            "clid": "\"+233241509420\" <+233241509420>",
            "src": "+233241509420",
            "dst": "11111",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-00000791",
            "dstchannel": "Agent/113",
            "lastapp": "Queue",
            "lastdata": "11111,t,,custom/Incoming_Call_English,,,,,,",
            "duration": 263,
            "billsec": 263,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748423609.2108",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11111-+233241509420-20250528-091340-1748423609.2108.WAV",
            "cnum": "+233241509420",
            "cnam": "+233241509420",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T09:06:12",
            "clid": "\"+233244839980\" <+233244839980>",
            "src": "+233244839980",
            "dst": "11112",
            "dcontext": "ext-queues",
            "channel": "SIP/ACET_Trunk_copy_8-00000790",
            "dstchannel": "Agent/113",
            "lastapp": "Queue",
            "lastdata": "11112,tr,,custom/Incoming_Call_Twi,,,,,,",
            "duration": 404,
            "billsec": 404,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748423172.2106",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/q-11112-+233244839980-20250528-090625-1748423172.2106.wav",
            "cnum": "+233244839980",
            "cnam": "+233244839980",
            "outbound_cnum": "",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "0242436900",
            "direction": "inbound"
        },
        {
            "calldate": "2025-05-28T09:03:50",
            "clid": "1010",
            "src": "1010",
            "dst": "0506743388",
            "dcontext": "from-internal",
            "channel": "SIP/1010-0000078e",
            "dstchannel": "SIP/connexcs-0000078f",
            "lastapp": "Dial",
            "lastdata": "SIP/connexcs/7525300506743388,300,Tt",
            "duration": 88,
            "billsec": 78,
            "disposition": "ANSWERED",
            "amaflags": 3,
            "accountcode": "",
            "uniqueid": "1748423030.2104",
            "userfield": "",
            "recordingfile": "/var/spool/asterisk/monitor/2025/05/28/out-0506743388-1010-20250528-090350-1748423030.2104.wav",
            "cnum": "1010",
            "cnam": "Ronny Tawiah",
            "outbound_cnum": "0242436900",
            "outbound_cnam": "",
            "dst_cnam": "",
            "did": "",
            "direction": "outbound"
        }
    ]
}

def main():
    print("üìÅ RECORDING FILE PATHS")
    print("=" * 50)
    
    # Extract all recording file paths
    recording_paths = get_recording_paths(your_json_data)
    
    print(f"Found {len(recording_paths)} recording files:\n")
    
    for i, path in enumerate(recording_paths, 1):
        print(f"{i:2d}. {path}")

if __name__ == "__main__":
    main() 